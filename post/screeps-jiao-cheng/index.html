
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>Screeps æ•™ç¨‹ | Malachite</title>
<meta name="description" content="å¤•ç„¼ã‘ã®ä¸­ã«å¸ã„è¾¼ã¾ã‚Œã¦æ¶ˆãˆã¦ã£ãŸ">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://malachiten.github.io/favicon.ico?v=1572505109874">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://malachiten.github.io/styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://malachiten.github.io">
        <img class="avatar" src="https://malachiten.github.io/images/avatar.png?v=1572505109874" alt="" width="32px" height="32px">
      </a>
      <a href="https://malachiten.github.io">
        <h1 class="site-title">Malachite</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            å…³äº
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
          <h2 class="post-title">Screeps æ•™ç¨‹</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2019-10-22</span>
            
          </div>
          <div class="post-content">
            <p>ä¸äº†è§£çš„äººå¯ä»¥å‰å¾€<a href="https://screeps.com/">Screepså®˜ç½‘</a>äº†è§£ä¸€ä¸‹ï¼Œä¹Ÿè®¸æˆ‘ä»¬èƒ½æˆä¸ºåŒä¸€ä¸ª<code>Shard</code>çš„é‚»å±…ã€‚</p>
<p>ä¸è¿‡ï¼Œçœ‹å®Œç®€ä»‹ä¹Ÿä¸è¦è´¸ç„¶åœ¨Steamè´­ä¹°ï¼Œæˆ‘æ‰“æ•™ç¨‹éƒ½æ‰“äº†ä¸æ­¢ä¸€æ•´å¤©ï¼Œè‚¯å®šæ˜¯é€€ä¸äº†æ¬¾çš„ã€‚åœ¨çœŸæ­£æ¥è§¦åˆ°æœ¬èº«ä¹‹å‰ï¼Œä¹Ÿä¸ä¼šçŸ¥é“å®ƒåˆ°åº•æ€æ ·ç©ã€‚ä¸è¿‡ï¼Œåœ¨å®˜ç½‘ä¸Šæœ‰å®ƒçš„ Live DEMO å¯ä¾›è¯•ç©ï¼Œå»ºè®®å°è¯•ã€‚</p>
<h2 id="è®©æˆ‘ä»¬å¼€å§‹å§ç•Œé¢ç®€ä»‹">è®©æˆ‘ä»¬å¼€å§‹å§ï¼šç•Œé¢ç®€ä»‹</h2>
<blockquote>
<p>Let's begin. This is a playing field called a &quot;room&quot;. In the real game, rooms are connected to each other with exits, but in the simulation mode only one room is available to you.</p>
</blockquote>
<p>å±å¹•ä¸­é—´çš„ä¸€å¤§ç‰‡å«åš<code>room</code>ï¼Œåœ¨å®é™…æ¸¸æˆä¸­ï¼Œå®ƒä¸å…¶ä»–æˆ¿é—´ç›¸è¿ï¼Œä½†æ˜¯åœ¨æ•™ç¨‹è¿™é‡Œï¼Œå®ƒä»…å¯¹ä½ å¼€æ”¾ã€‚</p>
<blockquote>
<p>The object in the center of the screen is your first spawn, your colony center.</p>
</blockquote>
<p>å±å¹•ä¸­é—´çš„ç‰©ä½“æ˜¯ä½ çš„<code>creep</code>ä»¬çš„ç”Ÿæˆå™¨ã€‚</p>
<blockquote>
<p>You play by writing code in the panel in the bottom of the screen.</p>
</blockquote>
<p>ä½ è¦æ“ä½œè¿™ä¸ªæ¸¸æˆï¼Œå°±å¾—åœ¨å±å¹•ä¸‹æ–¹çš„é»‘æ¡†æ¡†é‡Œé¢æ‰“ä»£ç ï¼Œå˜¿å˜¿å˜¿ã€‚</p>
<blockquote>
<p>You can see all the characteristics of your creep (or other objects) by utilizing the &quot;View&quot; action.</p>
</blockquote>
<p>ä½ è¦æƒ³çœ‹åˆ°ä½ çš„æ‰€æœ‰ç‰©ä½“çš„ä¿¡æ¯ï¼Œéœ€è¦åˆ‡æ¢åˆ°<code>View</code>è§†å›¾ã€‚å…·ä½“ä¸€ç‚¹ï¼Œç‚¹å‡»å±å¹•ä¸Šæ–¹çš„çœ¼ç›<br>
å›¾æ ‡å°±å¯ä»¥äº†ã€‚</p>
<blockquote>
<p>Hide the editor panel with Alt+Enter and select your creep with the help of the &quot;View&quot; action.</p>
</blockquote>
<p>å½“ä½ éœ€è¦æŸ¥çœ‹ä¿¡æ¯æ—¶ï¼ŒæŒ‰ä¸‹<code>Alt+Enter</code>éšè—ç¼–è¾‘å™¨ï¼Œç„¶åç‚¹å‡»ç›®æ ‡ã€‚</p>
<blockquote>
<p>Here you can see the characteristics of the object you are now looking at. Values of each characteristic and functions of body parts are described in the documentation.</p>
</blockquote>
<p>è¿™æ ·ï¼Œåœ¨å±å¹•å³ä¾§å·¥å…·æ ä¸­ï¼Œä½ å°±èƒ½çœ‹è§æ‰€é€‰ç›®æ ‡çš„å…¨éƒ¨å±æ€§ã€‚</p>
<h2 id="ç¬¬ä¸€ä¸ªè¦æ¥è§¦çš„ä¸œè¥¿æ§åˆ¶å°">ç¬¬ä¸€ä¸ªè¦æ¥è§¦çš„ä¸œè¥¿ï¼šæ§åˆ¶å°</h2>
<p><code>Console</code> æ§åˆ¶å° å…¶å®æ˜¯ä¸€ä¸ª<code>JavaScript</code>çš„ <strong>REPL</strong> (è¯»å…¥ - æ‰§è¡Œ - æ‰“å° - å¾ªç¯) ã€‚</p>
<p>è¾“å…¥ä¸€è¡Œæˆ–ä¸€å—<code>JavaScript</code>è¯­å¥ï¼Œç„¶åæŒ‰ä¸‹<code>Enter</code>æ‰§è¡Œã€‚</p>
<blockquote>
<p>Your command returns a response <s>or execution error</s> in the console below. All output is duplicated into your browser console (Ctrl+Shift+J) where you can expand objects for debugging purposes. You can open and close the bottom panel by pressing Alt+Enter.</p>
</blockquote>
<p>ä½ çš„å‘½ä»¤è¿”å›ä¸€ä¸ªç»“æœæˆ–ä¸€ä¸ªé”™è¯¯ï¼Œå°†ç«‹å³æ˜¾ç¤ºåœ¨æ§åˆ¶å°ã€‚</p>
<blockquote>
<p>It is time to put the creep to work! This yellow square is an energy source â€” a valuable game resource. It can be harvested by creeps with one or more <code>WORK</code> body parts and transported to the spawn by creeps with <code>CARRY</code> parts.</p>
</blockquote>
<p>ä¸‹é¢æµ‹è¯•ä¸‹æ§åˆ¶å°ï¼Œåœ¨æ§åˆ¶å°ä¸­ç”Ÿæˆä¸€ä¸ªå…·æœ‰<code>WORK</code>,<code>CARRY</code>,<code>MOVE</code> çš„èº«ä½“éƒ¨ä»¶çš„ Creep ã€‚</p>
<p>å…¶å®è¿™ä½¿ç”¨äº† API ï¼š</p>
<blockquote>
<p>Game.spawns<br>
StructureSpawn.spawnCreep</p>
</blockquote>
<pre><code class="language-javascript">Game.spawns['Spawn1'].spawnCreep( [WORK, CARRY, MOVE], 'Harvester1' );
</code></pre>
<p>è¿™å°±æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ª<code>Creep</code>ï¼Œå¯è§ï¼Œå®ƒæ˜¯ç”±åä¸º<code>Spawn1</code>çš„ç”Ÿæˆå™¨ç”Ÿæˆçš„ï¼Œï¼Œä¸”åä¸º<code>Harvester1</code>ã€‚</p>
<blockquote>
<p>You can address your spawn by its name the following way: Game.spawns['Spawn1'].</p>
</blockquote>
<p>è¿™å°±æ˜¯ç”Ÿæˆå™¨çš„è·¯å¾„ï¼š<code>Game.spawns['Spawn1']</code>ã€‚</p>
<blockquote>
<p>Great! You now have a creep with the name &quot;Harvester1&quot; that you can control.</p>
</blockquote>
<h2 id="ç„¶åå°±æ˜¯æœ€é‡è¦çš„è„šæœ¬ä¸­çš„-main-æ¨¡å—">ç„¶åå°±æ˜¯æœ€é‡è¦çš„ï¼Œè„šæœ¬ä¸­çš„ Main æ¨¡å—</h2>
<blockquote>
<p>To give your creep a permanently working command, the console is not enough, since we want the creep to work all the time. So we'll be using the Script tab rather than the console.</p>
</blockquote>
<p>æ§åˆ¶å°ä¸èƒ½æ»¡è¶³æˆ‘ä»¬ç»™<code>creep</code>ç¼–å†™å·¥ä½œè„šæœ¬çš„éœ€æ±‚ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨è„šæœ¬ç¼–è¾‘å™¨æ¥ç¼–å†™è¿™äº›è„šæœ¬ã€‚</p>
<blockquote>
<p>Here you can write scripts that will run on a permanent basis, each game tick in a loop. It allows writing constantly working programs to control behaviour of your creeps which will work even while you are offline (in the real game only, not the Simulation Room mode).</p>
</blockquote>
<p>åªè¦ä½ å†™äº†è„šæœ¬ï¼Œå®ƒå°±ä¼šä¸€ç›´å¾ªç¯æ‰§è¡Œï¼Œæ¯<code>Tick</code>ä¸€æ¬¡ï¼Œå³ä½¿ä½ ç¦»çº¿ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ï¼Œé™¤éä½ çš„<strong>æ‰€æœ‰</strong>æ®ç‚¹éƒ½è¢«äººç‚¸æ²¡äº†ã€‚å€¼å¾—ä¸€æï¼Œ<code>Tick</code>æ˜¯æ¸¸æˆçš„æ—¶é—´å•ä½ï¼Œå…·ä½“é•¿åº¦ç”±æœåŠ¡å™¨æ€§èƒ½åŠå»ºç«‹æ®ç‚¹çš„ç©å®¶æ•°ç›®å†³å®šã€‚Screepsä¸€å…±åŒ…å«å››ä¸ªæœåŠ¡å™¨ï¼Œè¶Šè€çš„æœåŠ¡å™¨è¿è¡Œé€Ÿåº¦è¶Šæ…¢ã€‚æœ€è€çš„æœåŠ¡å™¨<code>shard0</code>çš„å¹³å‡ticksæ—¶é•¿ç”šè‡³è¾¾åˆ°äº†æƒŠäººçš„5.9ç§’ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯è¿‡5.9ç§’ã€‚ä½ çš„ä»£ç æ‰ä¼šè¢«è¿è¡Œä¸€æ¬¡ã€‚ç©å®¶è¶Šæ¥è¶Šä¸æ»¡ç¼“æ…¢çš„æ¸¸æˆé€Ÿåº¦ï¼Œç”šè‡³å†³å®šåˆ°å…¶ä»–æœåŠ¡å™¨ä»å¤´å¼€å§‹ã€‚</p>
<blockquote>
<p>To commit a script to the game so it can run, use this button or Ctrl+Enter.</p>
</blockquote>
<p>æŒ‰ä¸‹<code>Ctrl + Enter</code>æäº¤ä½ çš„ä»£ç ã€‚è·Ÿå‘ä¸ª QQ æ¶ˆæ¯ä¸€æ ·ç®€å•ã€‚</p>
<blockquote>
<p>To send a creep to harvest energy, you need to use the methods described in the documentation section below. Commands will be passed each game tick. The harvest method requires that the energy source is adjacent to the creep.</p>
</blockquote>
<p>ä¸ºäº†è®©ä¸€ä¸ª<code>creep</code>æ”¶é›†èƒ½é‡ï¼Œä½ éœ€è¦å­¦ä¹ å®˜æ–¹ API æ–‡æ¡£ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚æ‰§è¡Œè¿™äº›æ–¹æ³•ï¼Œä»¥è®©å®ƒä»¬å·¥ä½œã€‚</p>
<blockquote>
<p>You give orders to a creep by its name this way: Game.creeps['Harvester1']. Use the FIND_SOURCES constant as an argument to the Room.find method.</p>
</blockquote>
<p>å…·ä½“æ¥è¯´ï¼Œåœ¨æ”¶é›†èµ„æºæ—¶ï¼Œéœ€è¦ç”¨åˆ°<code>Game.creeps[]</code>æ•°ç»„ã€å°†å¸¸æ•°<code>FIND_SOURCES</code>ä½œä¸ºå‚æ•°çš„æ–¹æ³•<code>Room.find()</code>ã€‚</p>
<p>è¿™æ¬¡ä½¿ç”¨çš„ API å¦‚ä¸‹ï¼Œå¯ä»¥åœ¨å®˜æ–¹æ–‡æ¡£ä¸­æŸ¥åˆ°ï¼š</p>
<blockquote>
<p>Game.creeps<br>
RoomObject.room<br>
Room.find<br>
Creep.moveTo<br>
Creep.harvest</p>
</blockquote>
<p>Code:</p>
<pre><code class="language-javascript">module.exports.loop = function () {
    var creep = Game.creeps['Harvester1'];
    var sources = creep.room.find(FIND_SOURCES);
    if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
        creep.moveTo(sources[0]);
    }
}
</code></pre>
<p>è¿™æ—¶ä½ çš„å”¯ä¸€ä¸€ä¸ª<code>Creep</code>ä¼šå‘åœ°å›¾ä¸Šæœ€è¿‘çš„é»„ç‚¹ç§»åŠ¨ï¼Œç„¶åå¼€å§‹å·¥ä½œã€‚è¿™ä¸ªé»„ç‚¹ç§°ä¸º<code>Source</code>ï¼Œå³èƒ½é‡æºã€‚</p>
<blockquote>
<p>A bubbling yellow spot inside the creep means that it has started collecting energy from the source.</p>
</blockquote>
<p>å¦‚æœä¸€ä¸ª<code>Creep</code>å†…éƒ¨çš„é¢œè‰²å˜æˆäº®é»„è‰²ï¼Œåˆ™è¯´æ˜å®ƒæ­£åœ¨æ”¶é›†èƒ½é‡æºä¸­çš„èƒ½é‡ã€‚</p>
<p><strong>It works!</strong></p>
<p>å¯æ˜¯ï¼Œå½“å…¶æ”¶é›†æ»¡è‡ªèº«å®¹é‡ä¹‹åï¼Œå°±éœ€è¦è¿”å›å‡ºç”Ÿç‚¹ (å³<code>Creep</code>çš„ç”Ÿæˆå™¨ï¼Œ<code>Spawn</code>) ã€‚</p>
<blockquote>
<p>To make the creep transfer energy back to the spawn, you need to use the method <code>Creep.transfer</code>. However, remember that it should be done when the creep is next to the spawn, so the creep needs to walk back.</p>
</blockquote>
<p>ä½¿ç”¨ API æä¾›çš„æ–¹æ³•<code>Creep.transfer</code>æ¥è¾¾æˆè¿™ä¸ªä»»åŠ¡ã€‚</p>
<blockquote>
<p>If you modify the code by adding the check <code>.carry.energy</code> &lt; <code>.carryCapacity</code>to the creep, it will be able to go back and forth on its own, giving energy to the spawn and returning to the source.</p>
</blockquote>
<p>è¿™æ˜¯ç®—æ³•çš„å®ç°æ–¹æ³•ï¼šç®€å•åˆ¤æ–­ç›®æ ‡<code>Creep</code>çš„æºå¸¦èƒ½é‡æ˜¯å¦å°äºå…¶æœ€å¤§å®¹é‡ã€‚å¦‚æœå°äºï¼Œåˆ™ä¸€ç›´è®©å®ƒæ”¶é›†ã€‚å¦åˆ™ï¼Œä»¤å…¶è¿”å›<code>Spawn</code>ï¼Œå°†èƒ½é‡æ³¨å…¥å…¶ä¸­ã€‚</p>
<p>è¦å®ç°è¿™äº›ï¼Œå¯å‚è§ API æ–‡æ¡£ï¼š</p>
<blockquote>
<p>Creep.transfer<br>
Creep.carry<br>
Creep.carryCapacity</p>
</blockquote>
<p>Code:</p>
<pre><code class="language-javascript">module.exports.loop = function () {
    var creep = Game.creeps['Harvester1'];

    if(creep.carry.energy &lt; creep.carryCapacity) {
        var sources = creep.room.find(FIND_SOURCES);
        if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
            creep.moveTo(sources[0]);
        }
    }
    else {
        if( creep.transfer(Game.spawns['Spawn1'], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE ) {
            creep.moveTo(Game.spawns['Spawn1']);
        }
    }
}
</code></pre>
<blockquote>
<p>Great! This creep will now work as a harvester until it dies. Remember that almost any creep has a life cycle of 1500 game ticks, then it &quot;ages&quot; and dies (this behavior is disabled in the Tutorial).</p>
</blockquote>
<p>è¿™æ ·å°±å®Œæˆäº†è®©å®ƒä¸€ç›´æ”¶é›†èƒ½é‡ç›´åˆ°æ­»äº¡çš„è§„åˆ’ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ¯ä¸ª<code>Creep</code>åœ¨å‡ºç”Ÿæ—¶å‡å…·å¤‡ 1500 ä¸ª<code>Ticks</code>çš„ç”Ÿå‘½æ—¶é•¿ï¼Œä¹‹åé€æ­¥å‡å°‘ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªè¡Œä¸ºåœ¨æ•™ç¨‹ä¸­è¢«ç¦ç”¨äº†ï¼Œç›®å‰ä½ çš„<code>Creep</code>å…·æœ‰æ— é™å¯¿å‘½ã€‚</p>
<blockquote>
<p>Let's create another worker creep to help the first one. It will cost another 200 energy units, so you may need to wait until your harvester collects enough energy. The spawnCreep method will return an error code <code>ERR_NOT_ENOUGH_ENERGY</code> (-6) until then.</p>
</blockquote>
<p>æˆ‘ä»¬é©¬ä¸Šå°±è¦å»ºé€ å¦ä¸€ä¸ªå·¥äºº<code>Creep</code>æ¥å¸®åŠ©å‡è½»ç¬¬ä¸€ä¸ªçš„è´Ÿæ‹…äº†ã€‚è¿™ä¼šæ¶ˆè€— 200 ä¸ªä¹‹å‰çš„å·¥äººæ”¶é›†æ¥çš„èƒ½é‡å•ä½ï¼Œæ‰€ä»¥ä½ éœ€è¦ç­‰å¾…ä½ çš„æ”¶é›†è€…æ”¶é›†è¶³å¤Ÿçš„èƒ½é‡ã€‚åœ¨ API ä¸­æä¾›çš„<code>spawnCreep</code>æ–¹æ³•åœ¨æ²¡æœ‰è¶³å¤Ÿèƒ½é‡çš„æ—¶å€™ï¼Œä¸ä¼šç”Ÿæˆ<code>Creep</code>ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªé”™è¯¯å¸¸é‡<code>ERR_NOT_ENOUGH_ENERGY</code>ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå®ƒçš„å€¼ä¸º -6 ã€‚</p>
<blockquote>
<p>Remember: to execute code once just type it in the &quot;Console&quot; tab.</p>
</blockquote>
<p>åƒè¿™ç§åªéœ€è¦æ‰§è¡Œä¸€æ¬¡çš„å‘½ä»¤ï¼Œå¯ä»¥åªç”¨å°†å…¶è¾“å…¥åˆ°æ§åˆ¶å°ã€‚</p>
<p>é‚£ä¹ˆå…·ä½“çš„æŒ‡ä»¤å°±å¾ˆç®€å•äº†ï¼š</p>
<pre><code class="language-javascript">Game.spawns['Spawn1'].spawnCreep( [WORK, CARRY, MOVE], 'Harvester2' );
</code></pre>
<blockquote>
<p>The second creep is ready, but it won't move until we include it into the program.</p>
</blockquote>
<p>ç”±äºæˆ‘ä»¬æ ¹æœ¬æ²¡å†™å®ƒçš„è„šæœ¬ï¼Œæ‰€ä»¥å®ƒæš‚æ—¶è¿˜ä¸ä¼šåŠ¨ã€‚</p>
<blockquote>
<p>To set the behavior of both creeps we could just duplicate the entire script for the second one, but it's much better to use the for loop against all the screeps in <code>Game.creeps</code>.</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥å•ç‹¬ä¸ºå®ƒç¼–å†™è„šæœ¬ï¼Œä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°å®ƒçš„è„šæœ¬å’Œç¬¬ä¸€ä¸ªå‡ ä¹æ²¡æœ‰å·®åˆ«ã€‚ä¸ºäº†<s>å·æ‡’</s>æé«˜ä»£ç å¤ç”¨ç‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¾ªç¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>Code:</p>
<pre><code class="language-javascript">module.exports.loop = function () {
    for(var name in Game.creeps) {
        var creep = Game.creeps[name];

        if(creep.carry.energy &lt; creep.carryCapacity) {
            var sources = creep.room.find(FIND_SOURCES);
            if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                creep.moveTo(sources[0]);
            }
        }
        else {
            if(creep.transfer(Game.spawns['Spawn1'], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {
                creep.moveTo(Game.spawns['Spawn1']);
            }
        }
    }
}
</code></pre>
<h2 id="ä¸ºäº†æ›´åŠ æè‡´çš„è„±å‘ä½“éªŒæˆ‘ä»¬è¿˜å¯ä»¥ç¼–å†™å…¶ä»–æ¨¡å—è¾¾æˆç›®çš„">ä¸ºäº†æ›´åŠ æè‡´çš„è„±å‘ä½“éªŒï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç¼–å†™å…¶ä»–æ¨¡å—è¾¾æˆç›®çš„ã€‚</h2>
<blockquote>
<p>Now let's improve our code by taking the workers' behavior out into a separate module. Create a module called role.harvester with the help of the Modules section on the left of the script editor and define a run function inside the <code>module.exports</code> object, containing the creep behavior.</p>
</blockquote>
<p>é™¤äº†<code>Main</code>ä¹‹å¤–çš„æ¨¡å—å°±åƒ C / C++ ä¸­çš„å¤´æ–‡ä»¶ï¼Œä¾›ç»™<code>Main</code>è°ƒç”¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œç¼–å†™ä¸€ä¸ªä¸“ä»¬æè¿°æ”¶é›†èƒ½é‡çš„å·¥äºº<code>Creep</code>çš„è¡Œä¸ºçš„æ¨¡å—ã€‚</p>
<p>Code:</p>
<pre><code class="language-javascript">var roleHarvester = {

    /** @param {Creep} creep **/
    run: function(creep) {
	    if(creep.carry.energy &lt; creep.carryCapacity) {
            var sources = creep.room.find(FIND_SOURCES);
            if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                creep.moveTo(sources[0]);
            }
        }
        else {
            if(creep.transfer(Game.spawns['Spawn1'], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {
                creep.moveTo(Game.spawns['Spawn1']);
            }
        }
	}
};

module.exports = roleHarvester;
</code></pre>
<p>è¿™ä»½è„šæœ¬æè¿°äº†æ‰€æœ‰å…·æœ‰<code>Harvester</code>æ€§è´¨çš„<code>Creep</code>çš„å·¥ä½œæµç¨‹ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚</p>
<p>é‚£ä¹ˆç°åœ¨ï¼Œæˆ‘ä»¬å¦‚ä½•ç¼–å†™æˆ‘ä»¬çš„<code>Main</code>æ¥è°ƒç”¨åˆšåˆšå†™çš„è¿™äº›å‘¢ï¼Ÿ</p>
<blockquote>
<p>Now you can rewrite the main module code, leaving only the loop and a call to your new module by the method <code>require('role.harvester')</code>.</p>
</blockquote>
<p>æ˜æ˜¾ï¼Œåªéœ€è¦ä½¿ç”¨<code>require('role.harvester')</code>çš„è¯­å¥ï¼Œå°±å¯ä»¥è¾¾æˆä¸ C / C++ ä¸­<code>#include &quot;role_harvester.hpp&quot;</code>ä¸€æ ·çš„æ•ˆæœäº†ã€‚</p>
<blockquote>
<p>It's much better now!</p>
</blockquote>
<p>å¤´å‘å°‘å¤šäº†ï¼</p>
<blockquote>
<p>By adding new roles and modules to your creeps this way, you can control and manage the work of many creeps. In the next Tutorial section, weâ€™ll develop a new creep role.</p>
</blockquote>
<p>é€šè¿‡ç»™ä½ çš„<code>creep</code>ä»¬æ·»åŠ æ–°çš„è§’è‰²å’Œæ¨¡å—ï¼Œä½ èƒ½æ§åˆ¶å¹¶ç®¡ç†å¤§é‡çš„<code>creeps</code>ã€‚ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬è¦å¼€å‘ä¸€ä¸ªæ–°çš„è§’è‰²ã€‚</p>
<h2 id="å‡çº§æˆ¿é—´æ§åˆ¶å™¨roomcontroller">å‡çº§æˆ¿é—´æ§åˆ¶å™¨RoomController</h2>
<blockquote>
<p>In this Tutorial section weâ€™ll talk about a key strategic object in your room: <code>Room Controller</code>. By controlling this invincible structure you can build facilities in the room. The higher the controller level, the more structures available to build.</p>
</blockquote>
<p>åœ¨è®¾è®¡è¿™ä¸ªæ–°çš„è§’è‰²ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¤è¯†ä¸€ä¸ªæ–°ä¸œè¥¿ï¼Œå«<code>Room Controller</code>ã€‚è¿™ä¸ªä¸œè¥¿çš„ç­‰çº§å†³å®šäº†ä½ èƒ½åœ¨ä½ æˆ¿é—´é‡Œé¢å»ºé€ å“ªäº›ç»“æ„ã€‚</p>
<blockquote>
<p>You will need a new worker creep to upgrade your controller level. Let's call it &quot;Upgrader1&quot;. In following sections we'll discuss how to create creeps automatically, but for now let's send a command manually to the console.</p>
</blockquote>
<p>ä¸ºäº†ç»™å®ƒå‡çº§ï¼Œæˆ‘ä»¬è¦é€ ä¸€ä¸ªåä¸ºâ€œUpgrader1â€çš„æ–°å·¥äººã€‚</p>
<p>åœ¨ä»¥åçš„æ•™ç¨‹ä¸­æˆ‘ä»¬ä¼šè®¤è¯†åˆ°å¦‚ä½•è‡ªåŠ¨ç”Ÿæˆ<code>creeps</code>ï¼Œä¸è¿‡è¿™æ¬¡ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨æ§åˆ¶å°å§ã€‚</p>
<p>Code:</p>
<pre><code class="language-javascript">Game.spawns['Spawn1'].spawnCreep( [WORK, CARRY, MOVE], 'Upgrader1' );
</code></pre>
<p>å®ƒå…·ä½“ç”Ÿæˆäº†ä»€ä¹ˆï¼Œæƒ³å¿…ä¸ç”¨å¤šè¯´äº†ã€‚</p>
<blockquote>
<p>Creep &quot;Upgrader1&quot; went to perform the same task as the harvester, but we don't want it to. We need to differentiate creep roles.</p>
</blockquote>
<p>ç›®å‰å®ƒæš‚æ—¶è¿˜åªèƒ½åƒ<code>harvester</code>ä¸€æ ·å·¥ä½œã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¾—å¹²ç‚¹ä»€ä¹ˆè®©å®ƒä¸è€å‰è¾ˆä¸ä¸€æ ·ã€‚</p>
<blockquote>
<p>To do that, we need to utilize the memory property of each creep that allows writing custom information into the creep's &quot;memory&quot;. Let's do this to assign different roles to our creeps.</p>
<p>All your stored memory is accessible via the global Memory object. You can use it any way you like.</p>
</blockquote>
<p>æˆ‘ä»¬ä½¿ç”¨<code>memory</code>æ¥åŒºåˆ†ä¸åŒ<code>creeps</code>å„è‡ªçš„è§’è‰²ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å¾€ä¸€ä¸ª<code>creep</code>çš„â€œè®°å¿†â€é‡Œé¢å†™ä»»ä½•ä¸œè¥¿æ¥è¾¾æˆæˆ‘ä»¬çš„ä»»æ„ç›®çš„ã€‚</p>
<p>Code:</p>
<pre><code class="language-javascript"> Game.creeps['Harvester1'].memory.role = 'harvester';
 Game.creeps['Upgrader1'].memory.role = 'upgrader';
</code></pre>
<blockquote>
<p>You can check your creeps' memory in either the creep information panel on the left or on the <code>Memory</code> tab.</p>
</blockquote>
<p>é€šè¿‡æ£€æŸ¥<code>Memory</code>é¢æ¿ï¼Œä½ å¯ä»¥ç¡®è®¤â€œä½ çš„<code>Creeps</code>æœ‰æ²¡æœ‰æ·±å…¥è´¯å½»ä½ çš„æ€æƒ³â€ã€‚</p>
<blockquote>
<p>Now let's define the behavior of the new creep. Both creeps should harvest energy, but the creep with the role harvester should bring it to the spawn, while the creep with the role upgrader should go to the Controller and apply the function <code>upgradeController</code> to it (you can get the Controller object with the help of the <code>Creep.room.controller</code> property).</p>
</blockquote>
<p>ç°åœ¨å¼€å·¥äº†ï¼Œå»è®¾è®¡æ–°<code>creep</code>çš„è¡Œä¸ºã€‚æ¯ä¸€ä¸ª<code>creep</code>éƒ½åº”å½“æ”¶é›†èƒ½é‡ï¼Œä½†æ˜¯<code>harvester</code>åº”è¯¥æŠŠèƒ½é‡é€åˆ°<code>spawn</code>ï¼Œè€Œ<code>upgrader</code>åº”è¯¥æŠŠèƒ½é‡é€å»<code>Room Controller</code>ã€‚</p>
<blockquote>
<p>In order to do this, weâ€™ll create a new module called <code>role.upgrader</code>.</p>
</blockquote>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬åº”å½“åˆ›å»ºä¸€ä¸ªåä¸º<code>role.upgrader</code>çš„<code>module</code>ã€‚</p>
<p>è¿™ç”¨åˆ°äº†è¿™äº› API ï¼š</p>
<blockquote>
<p>RoomObject.room<br>
Room.controller<br>
Creep.upgradeController</p>
</blockquote>
<p>Code:</p>
<pre><code class="language-javascript">var roleUpgrader = {

    /** @param {Creep} creep **/
    run: function(creep) {
	    if(creep.carry.energy == 0) {
            var sources = creep.room.find(FIND_SOURCES);
            if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                creep.moveTo(sources[0]);
            }
        }
        else {
            if(creep.upgradeController(creep.room.controller) == ERR_NOT_IN_RANGE) {
                creep.moveTo(creep.room.controller);
            }
        }
	}
};

module.exports = roleUpgrader;
</code></pre>
<blockquote>
<p>In our main module, all creeps run the same role. We need to divide their behavior depending on the previously defined property <code>Creep.memory.role</code> by connecting the new module.</p>
</blockquote>
<p>ç›®å‰æˆ‘ä»¬çš„<code>main</code>æ¨¡å—ä¸­ï¼Œæ‰€æœ‰<code>creeps</code>è¿˜è¢«å½“ä½œåŒä¸€ç§è§’è‰²å¤„ç†ã€‚è¿™æ˜¯ä¸è¡Œçš„ï¼šå¦‚æœ<code>main</code>è¯´æ˜¯ä¸€æ ·çš„å°±æ˜¯ä¸€æ ·çš„ï¼Œé‚£æˆ‘å¤šæ²¡é¢å­ã€‚æ‰€ä»¥</p>
<p>Code:</p>
<pre><code class="language-javascript">var roleHarvester = require('role.harvester');
var roleUpgrader = require('role.upgrader');

module.exports.loop = function () {

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'upgrader') {
            roleUpgrader.run(creep);
        }
    }
}
</code></pre>
<p>å¬æˆ‘çš„ï¼å¬æˆ‘çš„ï¼å¬æˆ‘çš„ï¼</p>
<p>æ‰€ä»¥â€”â€”</p>
<blockquote>
<p>Perfect, you have upgraded your Controller level!</p>
</blockquote>
<p><code>WA</code>ï¼Œä½ çš„å¤´å‘åˆå°‘äº†å‡ æ ¹ï¼</p>
<blockquote>
<p><strong>Important</strong>: If you donâ€™t upgrade your Controller within 20,000 game ticks, it loses one level. On reaching level 0, you will lose control over the room, and another player will be able to capture it freely. Make sure that at least one of your creeps regularly performs the function upgradeController.</p>
</blockquote>
<p>å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼šå¦‚æœä½ è¿ç»­ä¸¤ä¸‡ä¸ª<code>tick</code>ä¸å‡çº§ä½ çš„<code>Room Controller</code>ï¼Œå®ƒå°±ä¼šé™çº§ã€‚å½“å®ƒé™åˆ° 0 çº§æ—¶ï¼Œä½ å°±å¤±å»äº†è¿™ä¸ªæˆ¿é—´çš„æ§åˆ¶æƒã€‚</p>
<h2 id="å»ºé€ æ–°ç»“æ„">å»ºé€ æ–°ç»“æ„</h2>
<blockquote>
<p>The Controller upgrade gives access to some new structures: walls, ramparts, and extensions. Weâ€™ll discuss walls and ramparts in the next Tutorial section, for now letâ€™s talk about extensions.</p>
</blockquote>
<p>æ§åˆ¶å™¨ä¸€æ—¦è¢«å‡çº§ï¼Œä½ å°±å¯ä»¥è·å–å»ºé€ æ–°ç»“æ„çš„æƒé™ã€‚è¿™äº›ç»“æ„ä¸»è¦æœ‰ï¼šåœ°å½¢å¢™ã€é˜²å¾¡å£å’ï¼Œä»¥åŠæ‰©å±•ã€‚æˆ‘ä»¬æ•™ç¨‹çš„ä¸‹ä¸€æ­¥ä¼šè®²åˆ°åœ°å½¢å¢™å’ŒåŸå¢™ï¼Œè¿™æ¬¡åªä¼šè®²åˆ°æ‰©å±•ã€‚</p>
<blockquote>
<p><strong>Extensions</strong> are required to build larger creeps. A creep with only one body part of one type works poorly. Giving it several <strong>WORKs</strong> will make him work proportionally faster.</p>
</blockquote>
<p>å½“ä½ è§‰å¾—ä½ çš„<code>creeps</code>å·¥ä½œèƒ½åŠ›ä¸è¡Œçš„æ—¶å€™ï¼Œä½ æƒ³è¦å¾€ä½ çš„<code>creeps</code>èº«ä¸Šæ’æ›´å¤šçš„èº«ä½“éƒ¨ä»¶ã€‚ç»™ä»–æ›´å¼ºçš„å·¥ä½œèƒ½åŠ›ã€‚</p>
<blockquote>
<p>However, such a creep will be costly and a lone spawn can only contain 300 energy units. To build creeps costing over 300 energy units you need spawn extensions.</p>
</blockquote>
<p>å¯æ˜¯ï¼Œè¿™æ ·çš„<code>creeps</code>åŠ¿å¿…é€ æˆå»ºé€ èŠ±è´¹çš„æé«˜ã€‚ä½ çš„<code>spawn</code>åªèƒ½å®¹çº³ 300 å•ä½çš„èƒ½é‡ï¼Œæ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚å»ºé€ èŠ±è´¹é«˜äº 300 å•ä½èƒ½é‡çš„ <code>creeps</code>ï¼Œå°±éœ€è¦ä½¿ç”¨æ‰©å±•ã€‚</p>
<blockquote>
<p>The second Controller level has 5 extensions available for you to build.This number increases with each new level.</p>
</blockquote>
<p>æ§åˆ¶å™¨ç­‰çº§ 2 å…è®¸ä½ å»ºé€  5 ä¸ªæ‰©å±•ã€‚è€Œä¸”è¿™ä¸ªæ•°é‡è¿˜ä¼šéš<code>Room Controller</code>ç­‰çº§ä¸æ–­æå‡ã€‚</p>
<blockquote>
<p>You can place extensions at any spot in your room, and a spawn can use them regardless of the distance. In this Tutorial we have already placed corresponding construction sites for your convenience.</p>
</blockquote>
<p>ä½ å¯ä»¥å°†æ‰©å±•æ”¾åœ¨æˆ¿é—´çš„ä»»ä½•ä½ç½®ï¼Œè€Œä¸”ä¸€ä¸ª<code>spawn</code>å¯ä»¥åœ¨ä»»ä½•è·ç¦»ä½¿ç”¨å®ƒä»¬ã€‚åœ¨æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»å°†å…¶æ”¾ç½®åœ¨æ„é€ å¥½çš„ä½ç½®ä¸Šã€‚</p>
<blockquote>
<p>Letâ€™s create a new creep whose purpose is to build structures. This process will be similar to the previous Tutorial sections. But this time letâ€™s set <code>memory</code> for the new creep right in the method <code>Spawn.spawnCreep</code> by passing it in the third argument.</p>
</blockquote>
<p>æˆ‘ä»¬å»ºé€ ä¸€ç§æ–°ç±»å‹çš„<code>creep</code>æ¥å¹²è¿™äº‹ã€‚è¿™ç§äº‹æƒ…éå¸¸ç®€å•ï¼Œæˆ‘ä»¬ä¹‹å‰éƒ½åšå¾—å¤šäº†ã€‚ä¸è¿‡ï¼Œè¿™æ¬¡æˆ‘ä»¬è¯•è¯•æ–°çš„å†™æ³•ï¼šä½¿ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°æ¥ä¼ é€’å†…å­˜å€¼ï¼Œå…å»é‡æ–°è®¾ç½®å†…å­˜çš„éº»çƒ¦ã€‚</p>
<p>Code:</p>
<pre><code class="language-javascript">Game.spawns['Spawn1'].spawnCreep( [WORK, CARRY, MOVE], 'Builder1',
    { memory: { role: 'builder' } } );
</code></pre>
<p>åœ¨<code>builder</code>çš„å®šä¹‰æœªå£°æ˜æ—¶ï¼Œå®ƒå°†ä¸ä¼šç§»åŠ¨ã€‚</p>
<blockquote>
<p>As before, letâ€™s move this role into a separate module role.builder. The building is carried out by applying the method <code>Creep.build</code> to the construction sites searchable by <code>Room.find(FIND_CONSTRUCTION_SITES)</code>. The structure requires energy which your creep can harvest on its own.</p>
</blockquote>
<p>åƒä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦è®¾è®¡ä¸€ä¸ªæ–°<code>module</code>ã€‚</p>
<p><code>Creep.build</code>å’Œ<code>Room.find(FIND_CONSTRUCTION_SITES)</code>ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®åˆ°æˆ‘ä»¬ã€‚</p>
<blockquote>
<p>To avoid having the creep run back and forth too often but make it deplete the cargo, letâ€™s complicate our logic by creating a new Boolean variable <code>creep.memory.building</code> which will tell the creep when to switch tasks. We'll also add new <code>creep.say</code> call and <code>visualizePathStyle</code> option to the moveTo method to visualize the creep's intentions.</p>
</blockquote>
<p>ä¸ºäº†é¿å…å®ƒæ¥å›é¢‘ç¹è¿è¡Œè€—å°½è®¡ç®—èµ„æºï¼Œæˆ‘ä»¬è®¾è®¡ä¸€ä¸ªå¸ƒå°”å€¼<code>creep.memory.building</code>æ¥æ§åˆ¶å®ƒç©¶ç«Ÿæ˜¯æŒ–çŸ¿è¿˜æ˜¯å»ºé€ ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬æ‰“å¼€å¯è§†åŒ–å…¶ç§»åŠ¨è·¯å¾„çš„é€‰é¡¹ï¼Œå¹¶ä½¿ç”¨<code>creep.say</code>æ–¹æ³•ï¼Œæ¥ä½¿å®ƒæ‰€å¤„çš„æ¨¡å¼å¯è§†åŒ–ã€‚</p>
<p>è¿™æ¬¡ç”¨åˆ°äº†è¿™äº› API :</p>
<blockquote>
<p>RoomObject.room<br>
Room.find<br>
Creep.build<br>
Creep.say</p>
</blockquote>
<p>Code:</p>
<pre><code class="language-javascript">var roleBuilder = {

    /** @param {Creep} creep **/
    run: function(creep) {

	    if(creep.memory.building &amp;&amp; creep.carry.energy == 0) {
            creep.memory.building = false;
            creep.say('ğŸ”„ harvest');
	    }
	    if(!creep.memory.building &amp;&amp; creep.carry.energy == creep.carryCapacity) {
	        creep.memory.building = true;
	        creep.say('ğŸš§ build');
	    }

	    if(creep.memory.building) {
	        var targets = creep.room.find(FIND_CONSTRUCTION_SITES);
            if(targets.length) {
                if(creep.build(targets[0]) == ERR_NOT_IN_RANGE) {
                    creep.moveTo(targets[0], {visualizePathStyle: {stroke: '#ffffff'}});
                }
            }
	    }
	    else {
	        var sources = creep.room.find(FIND_SOURCES);
            if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                creep.moveTo(sources[0], {visualizePathStyle: {stroke: '#ffaa00'}});
            }
	    }
	}
};

module.exports = roleBuilder;
</code></pre>
<blockquote>
<p>Letâ€™s create a call of the new role in the main module and wait for the result.</p>
</blockquote>
<p>è¿™æ ·å°±å¯ä»¥äº†ã€‚ä¸è¿‡æˆ‘ä»¬è¿˜å¾—æ”¹æ”¹ä¸»æ¨¡å—<code>Main</code></p>
<p>Code:</p>
<pre><code class="language-javascript">var roleHarvester = require('role.harvester');
var roleBuilder = require('role.builder');

module.exports.loop = function () {

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'builder') {
            roleBuilder.run(creep);
        }
    }
}
</code></pre>
<blockquote>
<p>Your extensions have been built. Now letâ€™s learn to work with them.</p>
</blockquote>
<p>è¿™æ ·ä¸€æ¥ï¼Œæ‰©å±•å°±ä¿®å»ºå¥½äº†ã€‚é‚£ä¹ˆç°åœ¨æ€ä¹ˆè®©å®ƒä»¬å·¥ä½œå‘¢ï¼Ÿ</p>
<blockquote>
<p>Maintaining extensions requires you to teach your harvesters to carry energy not just to a spawn but also to extensions. To do this, you can either use the <code>Game.structures</code> object or search within the room with the help of <code>Room.find(FIND_STRUCTURES)</code>. In both cases, you will need to filter the list of items on the condition structure.<code>structureType == STRUCTURE_EXTENSION</code> (or, alternatively, <code>structure instanceof StructureExtension</code>) and also check them for energy load, as before.</p>
</blockquote>
<p>å…ˆè¦æ•™ä¼š<code>havester</code>å°†æ”¶é›†çš„èµ„æºæ³¨å…¥æ‰©å±•ã€‚å¦åˆ™è¿™äº›æ‰©å±•ç”¨å¤„ä¸å¤§ã€‚</p>
<p>æ‰€ç”¨ APIï¼š</p>
<blockquote>
<p>Game.structures<br>
Room.find<br>
StructureExtension</p>
</blockquote>
<p>Code:</p>
<pre><code class="language-javascript">var roleHarvester = {

    /** @param {Creep} creep **/
    run: function(creep) {
	    if(creep.carry.energy &lt; creep.carryCapacity) {
            var sources = creep.room.find(FIND_SOURCES);
            if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                creep.moveTo(sources[0], {visualizePathStyle: {stroke: '#ffaa00'}});
            }
        }
        else {
            var targets = creep.room.find(FIND_STRUCTURES, {
                    filter: (structure) =&gt; {
                        return (structure.structureType == STRUCTURE_EXTENSION || structure.structureType == STRUCTURE_SPAWN) &amp;&amp;
                            structure.energy &lt; structure.energyCapacity;
                    }
            });
            if(targets.length &gt; 0) {
                if(creep.transfer(targets[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {
                    creep.moveTo(targets[0], {visualizePathStyle: {stroke: '#ffffff'}});
                }
            }
        }
	}
};

module.exports = roleHarvester;
</code></pre>
<blockquote>
<p>To know the total amount of energy in the room, you can use the property <code>Room.energyAvailable</code>. Letâ€™s add the output of this property into the console in order to track it during the filling of extensions.</p>
</blockquote>
<p>åŒæ—¶ï¼Œä¸ºäº†å¾—çŸ¥æˆ¿é—´èƒ½æºæ€»æ•°ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ–¹æ³•<code>Room.energyAvailable</code>ï¼Œåœ¨<code>Main</code>ä¸­æ·»åŠ ä¸€ä¸ªè¾“å‡ºï¼Œè®©ç³»ç»Ÿè¾“å‡ºæ€»èƒ½æºä¿¡æ¯åˆ°æ§åˆ¶å°ã€‚</p>
<p>å¯èƒ½ç”¨åˆ°çš„ API æ–‡æ¡£æ˜¯ï¼š</p>
<blockquote>
<p>Room.energyAvailable</p>
</blockquote>
<p>Code:</p>
<pre><code class="language-javascript">var roleHarvester = require('role.harvester');
var roleBuilder = require('role.builder');

module.exports.loop = function () {

    for(var name in Game.rooms) {
        console.log('Room &quot;'+name+'&quot; has '+Game.rooms[name].energyAvailable+' energy');
    }

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'builder') {
            roleBuilder.run(creep);
        }
    }
}
</code></pre>
<blockquote>
<p>In total, we have 550 energy units in our spawn and extensions. It is enough to build a creep with the body [WORK,WORK,WORK,WORK,CARRY,MOVE,MOVE]. This creep will work 4 times faster than a regular worker creep. Its body is heavier, so weâ€™ll add another MOVE to it. However, two parts are still not enough to move it at the speed of a small fast creep which would require 4xMOVEs or building a road.</p>
</blockquote>
<p>å‡†å¤‡å¥½é€ ä¸ªå¤§å®¶ä¼™äº†å—ï¼Ÿå…·ä½“æœ‰å¤šå¤§ï¼Œè§è‹±æ–‡éƒ¨åˆ†ã€‚ï¼ˆç¬‘ï¼‰</p>
<blockquote>
<p>Building this creep took energy from all storages and completely drained them.</p>
</blockquote>
<p>ä¸ºäº†ä¾å€™è¿™ä¸ªå¤§å®¶ä¼™ï¼Œæˆ‘ä»¬çš„æ‰€æœ‰èƒ½é‡å­˜å‚¨å™¨éƒ½è€—å°½äº†ã€‚</p>
<blockquote>
<p>As you can see on the right panel, this powerful creep harvests 8 energy units per tick. A few such creeps can completely drain an energy source before it refills thus giving your colony a maximum energy boost.</p>
</blockquote>
<p>ä¸è¿‡å½“ä½ çœ‹åˆ°å®ƒçš„é¢æ¿æ—¶ï¼Œä½ ä¼šè§‰å¾—è¿™æ˜¯éå¸¸å€¼å¾—çš„ã€‚å®ƒèƒ½å¤Ÿåœ¨ 1 <code>Tick</code> ä¸­é‡‡é›† 8 å•ä½èƒ½é‡ï¼Œç»™äºˆä½ æå¤§çš„èƒ½æºæ”¯æŒã€‚</p>
<blockquote>
<p>Hence, by upgrading your Controller, constructing new extensions and more powerful creeps, you considerably improve the effectiveness of your colony work. Also, by replacing a lot of small creeps with fewer large ones, you save CPU resources on controlling them which is an important prerequisite to play in the online mode.</p>
</blockquote>
<p>å¯è§ï¼Œå‡çº§æ§åˆ¶å™¨ï¼Œå»ºé€ æ–°æ‰©å±•å’Œæ›´å¤šå¼ºå¤§çš„<code>Creeps</code>ï¼Œèƒ½å¤Ÿæé«˜å·¥ä½œæ•ˆç‡ï¼ŒèŠ‚çœä¸‹CPUæ—¶é—´ã€‚å€¼å¾—ä¸€æï¼Œä¸ºäº†é¿å…æœ‰ç©å®¶ä½¿ç”¨æ­»å¾ªç¯å¡ç³»ç»Ÿï¼Œå¯¹äºæ¯ä¸€ä¸ªç©å®¶çš„ä»£ç ï¼Œç³»ç»Ÿéƒ½æœ‰ä¸€ä¸ªCPUæ—¶é—´é™åˆ¶ï¼Œå¦‚æœä½ çš„ç¨‹åºè¿è¡Œè¶…å‡ºäº†CPUæ—¶é—´ï¼Œåˆ™ä¼šè¢«å¼ºåˆ¶æ‰“æ–­ï¼Œ<code>continue</code>åˆ°ä¸‹ä¸€æ¬¡å¾ªç¯ä¸­ã€‚å½“ç„¶ï¼Œè´­ä¹°è®¢é˜…ç”šè‡³ç»ˆèº«æ— é™CPUæ—¶é—´çš„å·¨ä½¬å¯ä»¥æ— è§†CPUæ—¶é—´é™åˆ¶ã€‚</p>
<h2 id="å…¨è‡ªåŠ¨ç”Ÿäº§æ–°creeps">å…¨è‡ªåŠ¨ç”Ÿäº§æ–°Creeps</h2>
<blockquote>
<p>Until now, we have created new creeps directly in the console. Itâ€™s not a good idea to do it constantly since the very idea of Screeps is making your colony control itself. You will do well if you teach your spawn to produce creeps in the room on its own.</p>
</blockquote>
<p>ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬éƒ½åœ¨ä½¿ç”¨æ§åˆ¶å°æ–°å»º<code>creep</code>ã€‚ç”±äºçœŸå®æ¸¸æˆä¸­æ‰€æœ‰<code>creeps</code>æœ‰ 1500 <code>ticks</code>çš„ç”Ÿå‘½é™åˆ¶ï¼Œä½ å¿…é¡»è¦è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªèƒ½è®©ä½ ä¸€ç›´æŒ‚ç€æœºæ‘¸é±¼çš„å¥½åŠæ³•ã€‚æˆ‘ä»¬éœ€è¦æ‰¾å‡ºè®©æœºå™¨ç»™æˆ‘ä»¬è‡ªåŠ¨åˆ›å»º<code>creep</code>çš„åŠæ³•ã€‚</p>
<blockquote>
<p>This is a rather complicated topic and many players spend months perfecting and refining their auto-spawning code. But letâ€™s try at least something simple and master some basic principles to start with.</p>
</blockquote>
<p>ä¸ºäº†æ”¹è¿›è‡ªå·±çš„è‡ªåŠ¨åˆ›å»ºå™¨ï¼Œå¾ˆå¤šç©å®¶èŠ±è´¹äº†å‡ ä¸ªæœˆçš„æ—¶é—´ã€‚ä¸è¿‡æˆ‘ä»¬ç”¨ä¸ç€é‚£ä¹ˆéº»çƒ¦â€”â€”è¿™åªæ˜¯ä¸ªæ•™ç¨‹ï¼Œæä¸ªå¤Ÿç”¨çš„å°±è¡Œäº†ã€‚</p>
<blockquote>
<p>You will have to create new creeps when old ones die from age or some other reasons. Since there are no events in the game to report death of a particular creep, the easiest way is to just count the number of required creeps, and if it becomes less than a defined value, to start spawning.</p>
</blockquote>
<p>ç”±äºæ¸¸æˆä¸æä¾›<code>creeps</code>æ­»äº¡æ—¶çš„å…¨å±€å¹¿æ’­ï¼Œæœ€ç®€å•çš„ç¡®è®¤æ˜¯å¦éœ€è¦æ–°å»º<code>creeps</code>çš„æ–¹æ³•å°±æ˜¯â€¦â€¦emmmï¼Œæ•°æ•°ã€‚æ²¡é”™ï¼Œæ•°ç°åœ¨ä½ è‡ªå·±æœ‰äº†å¤šå°‘<code>creeps</code>ï¼Œè€Œå®é™…ä¸Šéœ€è¦å¤šå°‘ã€‚å¦‚æœä¸å¤Ÿï¼Œå°±é€ ã€‚</p>
<blockquote>
<p>There are several ways to count the number of creeps of the required type. One of them is filtering <code>Game.creeps</code> with the help of the <code>_.filter</code> function and using the role in their memory. Letâ€™s try to do that and bring the number of creeps into the console.</p>
</blockquote>
<p>æœ‰å¾ˆå¤šç§æ–¹å¼è®©ä½ æ•°ä½ éœ€è¦çš„ç±»å‹çš„<code>creeps</code>æœ‰å¤šå°‘ä¸ªã€‚æœ€å¥½ç”¨çš„å°±æ˜¯åœ¨è¿‡æ»¤å™¨æˆå‘˜å‡½æ•°<code>filter</code>ååŠ©ä¸‹çš„<code>Game.creeps</code>å¯¹è±¡ã€‚åœ¨ä¸»æ¨¡å—ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è¿‡æ»¤å®ƒä»¬çš„<code>memory</code>æ¥åˆ¤æ–­å®ƒä»¬æ˜¯å¦æ˜¯é€‚åˆçš„ç±»å‹ï¼ŒåŒæ—¶ï¼Œå””ï¼Œæ•°æ•°ã€‚</p>
<p>å¯èƒ½ç”¨åˆ°çš„ API ï¼š</p>
<blockquote>
<p>Game.creeps<br>
lodash.filter</p>
</blockquote>
<p>Code:</p>
<pre><code class="language-javascript">var roleHarvester = require('role.harvester');
var roleUpgrader = require('role.upgrader');

module.exports.loop = function () {

    var harvesters = _.filter(Game.creeps, (creep) =&gt; creep.memory.role == 'harvester');
    console.log('Harvesters: ' + harvesters.length);

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'upgrader') {
            roleUpgrader.run(creep);
        }
    }
}
</code></pre>
<blockquote>
<p>Letâ€™s say we want to have at least two harvesters at any time. The easiest way to achieve this is to run <code>StructureSpawn.spawnCreep</code> each time we discover itâ€™s less than this number. You may not define its name (it will be given automatically in this case), but donâ€™t forget to define the needed role.</p>
</blockquote>
<p>æˆ‘ä»¬ç°åœ¨åŒæ—¶éœ€è¦ä¸¤ä¸ª<code>harvester</code>ã€‚æœ€æ–¹ä¾¿æ¥ä¿æŒè¿™ä¸ªçŠ¶æ€çš„æ–¹å¼å°±æ˜¯è®©ä¸»æ¨¡å—åœ¨æ¯æ¬¡å‘ç°<code>harvester</code>æ•°é‡ä¸å¤Ÿçš„æ—¶å€™æ‰§è¡Œ<code>StructureSpawn.spawnCreep</code>ã€‚åœ¨è¿™ä¸ªæ–¹æ³•çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬ç”šè‡³ä¸éœ€è¦ç»™å®ƒä»¬å‘½åï¼ˆæˆ‘ä»¬èƒ½å†™å‡ºè‡ªåŠ¨å‘½åç”¨çš„æ–¹æ³•ï¼‰ï¼Œåªè¦åˆ«å¿˜è®°å®šä¹‰è§’è‰²è¡Œä¸ºå°±è¡Œã€‚</p>
<blockquote>
<p>We may also add some new <code>RoomVisual</code> call in order to visualize what creep is being spawned.</p>
</blockquote>
<p>æˆ‘ä»¬è¿˜èƒ½æ·»åŠ ä¸€äº›æ–°çš„<code>RoomVisual</code>è°ƒç”¨æ¥å¯è§†åŒ–å“ªä¸€ç§<code>creep</code>æ­£åœ¨è¢«ç”Ÿäº§å‡ºæ¥ã€‚</p>
<p>è¿™é‡Œå¯èƒ½å¸®åˆ°å¿™çš„ API :</p>
<blockquote>
<p>StructureSpawn.spawnCreep<br>
RoomVisual</p>
</blockquote>
<p>Code:</p>
<pre><code class="language-javascript">var roleHarvester = require('role.harvester');
var roleUpgrader = require('role.upgrader');

module.exports.loop = function () {

    var harvesters = _.filter(Game.creeps, (creep) =&gt; creep.memory.role == 'harvester');
    console.log('Harvesters: ' + harvesters.length);

    if(harvesters.length &lt; 2) {
        var newName = 'Harvester' + Game.time;
        console.log('Spawning new harvester: ' + newName);
        Game.spawns['Spawn1'].spawnCreep([WORK,CARRY,MOVE], newName, 
            {memory: {role: 'harvester'}});        
    }
    
    if(Game.spawns['Spawn1'].spawning) { 
        var spawningCreep = Game.creeps[Game.spawns['Spawn1'].spawning.name];
        Game.spawns['Spawn1'].room.visual.text(
            'ğŸ› ï¸' + spawningCreep.memory.role,
            Game.spawns['Spawn1'].pos.x + 1, 
            Game.spawns['Spawn1'].pos.y, 
            {align: 'left', opacity: 0.8});
    }

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'upgrader') {
            roleUpgrader.run(creep);
        }
    }
}
</code></pre>
<blockquote>
<p>Now letâ€™s try to emulate a situation when one of our harvesters dies. You can now give the command suicide to the creep via the console or its properties panel on the right.</p>
</blockquote>
<p>æˆ‘ä»¬ç°åœ¨æ¨¡æ‹Ÿä¸€ä¸‹å½“æˆ‘ä»¬çš„<code>harvesters</code>ä¸­çš„ä¸€ä½æ°¸è¿œåœ°ç¦»å¼€æˆ‘ä»¬çš„æƒ…å†µâ€¦â€¦å—¯ï¼Œç”¨æŸä¸ªæ–¹æ³•è®©å®ƒå½“åœºæŒ‚æ‰å°±è¡Œã€‚</p>
<p>å¯èƒ½ç”¨åˆ°çš„ API ï¼š</p>
<blockquote>
<p>Creep.suicide</p>
</blockquote>
<p>ï¼ˆæœ‰æ²¡æœ‰æ„Ÿåˆ°ä¸€ç§æ·±æ·±çš„æ¶æ„ï¼‰</p>
<pre><code class="language-javascript">Game.creeps['Harvester1'].suicide()
</code></pre>
<blockquote>
<p>As you can see from the console, after we lacked one harvester, the spawn instantly started building a new one with a new name.</p>
</blockquote>
<p>ä»æ§åˆ¶å°ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ¯å½“æˆ‘ä»¬ç¼ºä¹<code>harvester</code>æ—¶ï¼Œæˆ‘ä»¬çš„<code>spawn</code>å°±ä¼šè‡ªåŠ¨åœ°é€ ä¸€ä¸ªå…·å¤‡æ–°åå­—çš„<code>harvester</code>å‡ºæ¥ã€‚</p>
<blockquote>
<p>An important point here is that the memory of dead creeps is not erased but kept for later reuse. If you create creeps with random names each time it may lead to memory overflow, so you should clear it in the beginning of each tick (prior to the creep creation code).</p>
</blockquote>
<p>å¦å¤–çš„ä¸€ä¸ªé‡ç‚¹ï¼Œå°±æ˜¯ä½ çš„<code>creeps</code>å‡‰çš„æ—¶å€™ä¸ä¼šæ¸…ç©ºå®ƒæ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚ä¸€ä¸ªéšæœºåå­—çš„<code>creep</code>æŒ‚äº†ä¹‹åï¼Œå¯èƒ½ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚ä¸ºäº†åº”å¯¹è¿™ä¸ªæƒ…å†µï¼Œä½ éœ€è¦ä¿®æ”¹ä¸»æ¨¡å—ï¼Œåœ¨æ¯ä¸ª<code>tick</code>çš„å¼€å§‹æ—¶è¿›è¡Œå†…å­˜åƒåœ¾å›æ”¶ï¼Œå®ƒçš„ä¼˜å…ˆçº§ç”šè‡³é«˜äºç”Ÿäº§å»ºé€ æ–°<code>creep</code>çš„æŒ‡ä»¤ã€‚</p>
<p>Code:</p>
<pre><code class="language-javascript">var roleHarvester = require('role.harvester');
var roleUpgrader = require('role.upgrader');

module.exports.loop = function () {

    for(var name in Memory.creeps) {
        if(!Game.creeps[name]) {
            delete Memory.creeps[name];
            console.log('Clearing non-existing creep memory:', name);
        }
    }

    var harvesters = _.filter(Game.creeps, (creep) =&gt; creep.memory.role == 'harvester');
    console.log('Harvesters: ' + harvesters.length);

    if(harvesters.length &lt; 2) {
        var newName = 'Harvester' + Game.time;
        console.log('Spawning new harvester: ' + newName);
        Game.spawns['Spawn1'].spawnCreep([WORK,CARRY,MOVE], newName, 
            {memory: {role: 'harvester'}});
    }
    
    if(Game.spawns['Spawn1'].spawning) { 
        var spawningCreep = Game.creeps[Game.spawns['Spawn1'].spawning.name];
        Game.spawns['Spawn1'].room.visual.text(
            'ğŸ› ï¸' + spawningCreep.memory.role,
            Game.spawns['Spawn1'].pos.x + 1, 
            Game.spawns['Spawn1'].pos.y, 
            {align: 'left', opacity: 0.8});
    }

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'upgrader') {
            roleUpgrader.run(creep);
        }
    }
}
</code></pre>
<blockquote>
<p>Now the memory of the deceased is relegated to oblivion which saves us resources.</p>
</blockquote>
<p>æˆ‘å¾ˆé«˜å…´ä½ èŠ‚çœä¸‹äº†ä¸€ç‚¹å†…å­˜ã€‚<s>ä¸€ç›´èŠ‚çœå†…å­˜ï¼Œä½ å°±èƒ½å­˜ä¸‹é’±æ¥ä¹°ç”Ÿå‘å‰‚ã€‚</s></p>
<blockquote>
<p>Apart from creating new creeps after the death of old ones, there is another way to maintain the needed number of creeps: the method <code>StructureSpawn.renewCreep</code>. Creep aging is disabled in the Tutorial, so we recommend that you familiarize yourself with it on your own.</p>
</blockquote>
<p>å®é™…ä¸Šï¼Œé™¤äº†è®©æ—§çš„<code>creep</code>è€åŒ–æ­»æ‰æ—¶åˆ›å»ºæ–°çš„<code>creep</code>ï¼Œä½ è¿˜èƒ½ä½¿ç”¨<code>StructureSpawn.renewCreep</code>æ–¹æ³•è§£å†³é—®é¢˜ã€‚è€åŒ–åœ¨æ•™ç¨‹ä¸­è¢«ç¦ç”¨ï¼Œæ‰€ä»¥å»ºè®®è‡ªè¡Œç†Ÿæ‚‰ã€‚</p>
<p>ä¸ä¹‹ç›¸å…³çš„ APIï¼š</p>
<blockquote>
<p>StructureSpawn.renewCreep</p>
</blockquote>
<h2 id="å®ˆå«ä½ çš„æˆ¿é—´">å®ˆå«ä½ çš„æˆ¿é—´</h2>
<blockquote>
<p>The world of Screeps is not the safest place. Other players may have claims on your territory. Besides, your room may be raided by neutral NPC creeps occasionally. So you ought to think about your colony defense in order to develop it successfully.</p>
</blockquote>
<p>Screepsä¸­ï¼Œç©å®¶å¯ä»¥äº’ç›¸æ”»å‡»ï¼Œè¿˜ä¼šäº§ç”Ÿæ•Œå¯¹NPCã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å¼€å‘é˜²å¾¡è„šæœ¬ã€‚</p>
<blockquote>
<p>This hostile creep has come from the left entry and attacked your colony. Itâ€™s good that we have walls to restrain it temporarily. But they will fall sooner or later, so we need to deal with the problem.</p>
</blockquote>
<p>å…¥ä¾µè€…å·²ç»ä»å·¦ä¾§å…¥å£è¿›å…¥å¹¶å·²ç»åœ¨æ”»å‡»ä½ çš„é¢†åœ°ã€‚æˆ‘ä»¬æœ‰å¢™å¯ä»¥é˜²å¾¡ï¼Œä½†æ˜¯è¿™äº›å¢™è¿Ÿæ—©ä¼šå€’ä¸‹ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åº”è¯¥ç§¯æåº”å¯¹è¿™ä¸€é—®é¢˜ã€‚</p>
<blockquote>
<p>The surest way to fend off an attack is using the room Safe Mode. In safe mode, no other creep will be able to use any harmful methods in the room (but youâ€™ll still be able to defend against strangers).</p>
</blockquote>
<p>ç›®å‰æœ€å¯é çš„é˜²å¾¡æ–¹å¼ï¼Œæ˜¯ä½¿ç”¨æˆ¿é—´å®‰å…¨æ¨¡å¼<code>room Safe Mode</code>ã€‚åœ¨å®‰å…¨æ¨¡å¼æ—¶é™å†…ï¼Œæ•Œäººçš„æ‰€æœ‰æœ‰å®³æ–¹æ³•éƒ½ä¼šè¢«é”æ­»ã€‚è¿™æ˜¯å¯¹äºé™Œç”Ÿæ¥è®¿è€…æœ€å¥½çš„é˜²å¾¡æ–¹å¼ã€‚</p>
<blockquote>
<p>The safe mode is activated via the room controller which should have activations available to use. Letâ€™s spend one activation to turn it on in our room.</p>
</blockquote>
<p>æˆ‘ä»¬éœ€è¦é€šè¿‡æˆ¿é—´æ§åˆ¶å™¨æ‰èƒ½æ‰“å¼€æˆ¿é—´å®‰å…¨æ¨¡å¼ã€‚è®©æˆ‘ä»¬è¯•è¯•ã€‚<s>(è¯•è¯•å°±é€ä¸–)</s></p>
<p>è¿™ä¸ªæ“ä½œæ‰€ç”¨çš„æ–¹æ³•æ¶‰åŠ APIï¼š</p>
<blockquote>
<p>StructureController.activateSafeMode</p>
</blockquote>
<p>è¿™ç§å³æ—¶æ€§å¼ºçš„ä»£ç ä½¿ç”¨æ§åˆ¶å°æ¥æ‰§è¡Œï¼š</p>
<p>Code:</p>
<pre><code class="language-javascript">Game.spawns['Spawn1'].room.controller.activateSafeMode();
</code></pre>
<blockquote>
<p>As you can see, the enemy creep stopped attacking the wall â€“ its harmful methods are blocked. We recommend that you activate safe mode when your defenses fail.</p>
</blockquote>
<p>å¯è§ï¼Œè¯¥æ•Œå¯¹<code>Creep</code>åœæ­¢æ”»å‡»å¢™å£ï¼Œä¸€åˆ‡æœ‰å®³è¡Œä¸ºå‡å·²é”å®šã€‚æˆ‘ä»¬å»ºè®®ä½ åœ¨é˜²å®ˆå¤±è´¥æ—¶æ¿€æ´»æˆ¿é—´å®‰å…¨æ¨¡å¼ã€‚</p>
<blockquote>
<p>Now letâ€™s cleanse the room from unwanted guests.</p>
</blockquote>
<p>é‚£ä¹ˆç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¸…é™¤ä¸å—æ¬¢è¿çš„å…¥ä¾µè€…ã€‚</p>
<blockquote>
<p>Towers are the easiest way to actively defend a room. They use energy and can be targeted at any creep in a room to attack or heal it. The effect depends on the distance between the tower and the target.</p>
</blockquote>
<p>å¡”æ˜¯ç§¯ææ´»è·ƒé˜²å¾¡æˆ¿é—´çš„ä¼˜ç§€æ–¹å¼ã€‚å®ƒä»¬æ¶ˆè€—èƒ½é‡ï¼Œå¹¶ä»¥<code>Creep</code>ä¸ºç›®æ ‡è¿›è¡Œç»´æŠ¤æˆ–æ”»å‡»ã€‚æ•ˆæœå–å†³äºå¡”ç¦»ç›®æ ‡çš„è·ç¦»</p>
<blockquote>
<p>To start with, letâ€™s lay a foundation for our new tower. You can set any place you wish inside the walls and place the construction site there with the help of the button â€œConstructâ€ on the upper panel.</p>
</blockquote>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ä¸ºå»ºé€ æ–°å¡”æ‰“å¥½åŸºç¡€ã€‚ä½ èƒ½å¤Ÿä½¿ç”¨<code>Construct</code>è§†å›¾åœ¨å¢™å†…ä»»æ„ä½ç½®å»ºé€ ä¸€åº§å¡”ã€‚</p>
<p>API è°ƒç”¨å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>StructureTower<br>
Room.createConstructionSite</p>
</blockquote>
<p>Code:</p>
<pre><code class="language-javascript">Game.spawns['Spawn1'].room.createConstructionSite( 23, 22, STRUCTURE_TOWER );
</code></pre>
<blockquote>
<p>A tower uses energy, so letâ€™s set the harvester role to bring energy to the tower along with other structures. To do this, you need to add the constant STRUCTURE_TOWER to the filter of structures your harvester is aimed at.</p>
</blockquote>
<p>å¡”æ¶ˆè€—èƒ½æºã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æ›´æ”¹<code>Harvester</code>çš„æ¨¡å—ï¼Œä½¿è¯¥è§’è‰²å°†èƒ½æºå¸¦ç»™å¡”åŠå…¶ä»–ç»“æ„ã€‚</p>
<pre><code class="language-javascript">var roleHarvester = {

    /** @param {Creep} creep **/
    run: function(creep) {
	    if(creep.carry.energy &lt; creep.carryCapacity) {
            var sources = creep.room.find(FIND_SOURCES);
            if(creep.harvest(sources[0]) == ERR_NOT_IN_RANGE) {
                creep.moveTo(sources[0], {visualizePathStyle: {stroke: '#ffaa00'}});
            }
        }
        else {
            var targets = creep.room.find(FIND_STRUCTURES, {
                    filter: (structure) =&gt; {
                        return (structure.structureType == STRUCTURE_EXTENSION ||
                                structure.structureType == STRUCTURE_SPAWN ||
                                structure.structureType == STRUCTURE_TOWER) &amp;&amp; structure.energy &lt; structure.energyCapacity;
                    }
            });
            if(targets.length &gt; 0) {
                if(creep.transfer(targets[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE) {
                    creep.moveTo(targets[0], {visualizePathStyle: {stroke: '#ffffff'}});
                }
            }
        }
	}
};

module.exports = roleHarvester;
</code></pre>
<blockquote>
<p>Excellent, your tower is ready to use!</p>
</blockquote>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå¡”æ¶ˆè€—å¤´å‘è€Œäº§ç”ŸæŸç§æ•ˆæœâ€¦â€¦å—¯ã€‚</p>
<blockquote>
<p>Like a creep, a tower has several similar methods: attack, heal, and repair. Each action spends 10 energy units. We need to use attack on the closest enemy creep upon its discovery. Remember that distance is vital: the effect can be several times stronger with the same energy cost!</p>
</blockquote>
<p>å°±åƒä¸€ä¸ª<code>Creep</code>ï¼Œå¡”å¯ä»¥æ”»å‡»ã€ç»™<code>Creep</code>å›å¤ç”Ÿå‘½ã€ç»´ä¿®å»ºç­‘ç‰©ã€‚æ¯ä¸€é¡¹æ–¹æ³•çš„æ‰§è¡Œå‡æ¶ˆè€—10å•ä½èƒ½é‡ã€‚æˆ‘ä»¬ç°åœ¨å¯¹å®ƒè¿›è¡Œè®¾å®šï¼Œä½¿å®ƒæ”»å‡»æœ€è¿‘çš„æ•Œäººã€‚è®°ä½ï¼Œå®ƒçš„æ•ˆæœå–å†³äºç¦»ç›®æ ‡çš„è·ç¦»ï¼</p>
<blockquote>
<p>To get the tower object directly you can use its ID from the right panel and the method <code>Game.getObjectById</code>.</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å³è¾¹çš„é¢æ¿ä»¥åŠ API æ–¹æ³•<code>Game.getObjectById</code>æ¥æ“ä½œç›´æ¥è·å–å¡”å¯¹è±¡ã€‚</p>
<p>è¿™å›ç”¨åˆ°çš„ API ä¸å°‘ï¼š</p>
<blockquote>
<p>Game.getObjectById<br>
RoomObject.pos<br>
RoomPosition.findClosestByRange<br>
StructureTower.attack</p>
</blockquote>
<p>è¿™æ ·ä¿®æ”¹ä¸»æ¨¡å—ï¼š</p>
<pre><code class="language-javascript">var roleHarvester = require('role.harvester');
var roleUpgrader = require('role.upgrader');
var roleBuilder = require('role.builder');

module.exports.loop = function () {

    var tower = Game.getObjectById('d629245dccf490c645352fb6');
    if(tower) {
        var closestHostile = tower.pos.findClosestByRange(FIND_HOSTILE_CREEPS);
        if(closestHostile) {
            tower.attack(closestHostile);
        }
    }

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'upgrader') {
            roleUpgrader.run(creep);
        }
        if(creep.memory.role == 'builder') {
            roleBuilder.run(creep);
        }
    }
}
</code></pre>
<p>å¯è§ï¼Œè¿™æ¬¡å¡”çš„ ID ä¸ºï¼š<code>d629245dccf490c645352fb6</code>ã€‚</p>
<blockquote>
<p>The enemy creep is eliminated and our colony can breathe easy. However, the invader has damaged some walls during the brief attack. Youâ€™d better set up auto-repair.</p>
</blockquote>
<p>æ•Œäººå·²ç»è¢«æ¶ˆç­ï¼Œä½†æ˜¯å®ƒç•™ä¸‹çš„ä¼¤å®³è¿˜æ²¡æœ‰è¢«ç£¨ç­ã€‚æ•Œå¯¹ç›®æ ‡æ”»å‡»äº†ä½ çš„å¢™ï¼Œå› æ­¤ä½ éœ€è¦ç»´æŠ¤å®ƒï¼Œä»¥åº”å¯¹ä¸‹ä¸€æ¬¡å…¥ä¾µã€‚å®é™…ä¸Šï¼Œå®ç°ä¸€ä¸ªè‡ªåŠ¨ä¿®å¤æ˜¯å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<blockquote>
<p>Damaged structures can be repaired by both creeps and towers. Letâ€™s try to use a tower for that. Weâ€™ll need the method <code>repair</code>. You will also need the method <code>Room.find</code> and a filter to locate the damaged walls.</p>
</blockquote>
<p>å—ä¼¤çš„ç»“æ„ï¼Œèƒ½å¤Ÿè¢«<code>creeps</code>å’Œ<code>towers</code>ä¿®å¤ã€‚è®©æˆ‘ä»¬è¯•è¯•æˆ‘ä»¬è¿™åº§å¡”çš„<code>repair</code>æ–¹æ³•ã€‚åœ¨å®é™…çš„å®ç°è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>Room.find</code>æ–¹æ³•é…åˆè¿‡æ»¤å™¨æ‰¾åˆ°å¢™ä¸Šå—åˆ°æŸä¼¤çš„ä½ç½®ã€‚</p>
<p>APIï¼š</p>
<blockquote>
<p>Room.find<br>
StructureTower.repair</p>
</blockquote>
<p>ä¸»æ¨¡å—ä»£ç ï¼š</p>
<pre><code class="language-javascript">var roleHarvester = require('role.harvester');
var roleUpgrader = require('role.upgrader');
var roleBuilder = require('role.builder');

module.exports.loop = function () {

    var tower = Game.getObjectById('d629245dccf490c645352fb6');
    if(tower) {
        var closestDamagedStructure = tower.pos.findClosestByRange(FIND_STRUCTURES, {
            filter: (structure) =&gt; structure.hits &lt; structure.hitsMax
        });
        if(closestDamagedStructure) {
            tower.repair(closestDamagedStructure);
        }

        var closestHostile = tower.pos.findClosestByRange(FIND_HOSTILE_CREEPS);
        if(closestHostile) {
            tower.attack(closestHostile);
        }
    }

    for(var name in Game.creeps) {
        var creep = Game.creeps[name];
        if(creep.memory.role == 'harvester') {
            roleHarvester.run(creep);
        }
        if(creep.memory.role == 'upgrader') {
            roleUpgrader.run(creep);
        }
        if(creep.memory.role == 'builder') {
            roleBuilder.run(creep);
        }
    }
}
</code></pre>
<blockquote>
<p>All the damage from the attack has been repaired</p>
</blockquote>
<p>æˆ‘ä»¬æ³¨æ„åˆ°äº†ä½ å‘é‡è§åº•äº†ã€‚</p>
<blockquote>
<p>Congratulations, you have completed the Tutorial! Now you have enough knowledge and code to start playing in the online mode. Choose your room, found a colony, and set out on your own quest for domination in the world of Screeps!</p>
</blockquote>
<p>æ‰€ä»¥æ•™ç¨‹ç»“æŸäº†ã€‚æ­å–œä½ ï¼Œä½ å·²ç»ç»ƒæˆäº†è¿›å…¥ç§ƒå¤´æœåŠ¡å™¨çš„èƒ½åŠ›ã€‚é€‰æ‹©ä½ çš„æˆ¿é—´ï¼Œå»ºç«‹ä½ çš„é¢†åœ°ï¼Œè·Ÿæˆ‘ä»¬ä¸€èµ·è„±å‘å­ï¼</p>
<p>åœ¨è¿™äº›åœ°æ–¹ï¼Œä½ èƒ½ç»§ç»­æ‰¾åˆ°ä½ ä»¬éœ€è¦çš„ä¸œè¥¿ï¼š</p>
<blockquote>
<p>Documentation<br>
Community forums<br>
Slack chat</p>
</blockquote>
<blockquote>
<p>Have fun scripting!</p>
</blockquote>
<p>åœ¨è„±å‘ä¸­å¯»æ‰¾å¿«ä¹ï¼</p>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://malachiten.github.io/post/bi-ji-zui-xiao-sheng-cheng-shu-kruskal-suan-fa">
              <h3 class="post-title">
                ä¸‹ä¸€ç¯‡ï¼šç¬”è®° : æœ€å°ç”Ÿæˆæ ‘ / Kruskalç®—æ³•
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">å¤•ç„¼ã‘ã®ä¸­ã«å¸ã„è¾¼ã¾ã‚Œã¦æ¶ˆãˆã¦ã£ãŸ</div>
  <div class="social-container">
    
      
        <a href="https://github.com/MalachiteN" target="_blank">
          <i class="fab fa-github"></i>
        </a>
      
    
      
    
      
    
      
        <a href="https://www.zhihu.com/people/bao-chi-leng-jing-rev4/activities" target="_blank">
          <i class="fab fa-zhihu"></i>
        </a>
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> and <a herf="https://github.com/MalachiteN">MalachiteN</a> | <a class="rss" href="https://malachiten.github.io/atom.xml" target="_blank">RSS</a>
  <div>
    <span id="busuanzi_container_site_pv">
      æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
    </span>
  </div>
</div>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
